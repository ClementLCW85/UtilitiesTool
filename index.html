<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seapark Block E Utility Tracker</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <h1>Seapark Apartment Block E - Utility Tracker</h1>
        <nav>
            <ul>
                <li><a href="#dashboard">Dashboard</a></li>
                <li><a href="#submit-payment">Submit Payment</a></li>
                <li><a href="#admin">Admin</a></li>
            </ul>
        </nav>
    </header>

    <main id="app">
        <!-- Public Dashboard Section -->
        <section id="dashboard" class="view-section">
            <h2>Public Dashboard</h2>

            <!-- 1. Chart Section (Top) -->
            <div id="chart-controls" style="text-align: center; margin-bottom: 10px;">
                <label>Filter by Floor: </label>
                <button class="floor-btn active" data-floor="all">All</button>
                <button class="floor-btn" data-floor="1">Level 1</button>
                <button class="floor-btn" data-floor="2">Level 2</button>
                <button class="floor-btn" data-floor="3">Level 3</button>
                <button class="floor-btn" data-floor="4">Level 4</button>
            </div>

            <div id="chart-container">
                <p id="chart-loading-msg">Loading chart...</p>
                <div class="chart-scroll-wrapper">
                    <canvas id="unit-bar-chart"></canvas>
                </div>
            </div>
            
            <!-- 2. Stats Section -->
            <div id="stats-overview" class="stats-grid" style="margin-top: 20px;">
                <div class="stat-card">
                    <h3>Global Break-Even</h3>
                    <p id="stat-total-bills" class="stat-value">Loading...</p>
                    <span class="stat-label">Total Bills to Date</span>
                </div>
                <div class="stat-card">
                    <h3>Target Per Unit</h3>
                    <p id="stat-unit-target" class="stat-value">Loading...</p>
                    <span class="stat-label">Share (1/44)</span>
                </div>
                <div class="stat-card">
                    <h3>Total Collected</h3>
                    <p id="stat-total-collected" class="stat-value">Loading...</p>
                    <span class="stat-label">From 44 Units</span>
                </div>
                <div class="stat-card">
                    <h3>Status</h3>
                    <p id="stat-status" class="stat-value">Loading...</p>
                    <span class="stat-label">Deficit / Surplus</span>
                </div>
            </div>
            
            <!-- Context Note -->
            <div style="text-align: center; margin: 10px 0 20px 0; color: #555;">
                <p id="stats-context-msg" class="small-note">Loading context...</p>
                
                <!-- Bill Detail View -->
                <div id="dashboard-bills-wrapper" style="display:none; margin-top: 10px;">
                    <button id="toggle-dashboard-bills" class="text-btn" style="font-size: 0.85rem;">Show Bill Details</button>
                    <div id="dashboard-bills-details" style="display:none; text-align: left; margin: 10px auto; max-width: 500px; background: #fafafa; padding: 15px; border-radius: 6px; font-size: 0.9em; border: 1px solid #eee;">
                        <strong>Included Monthly Bills:</strong>
                        <ul id="dashboard-bills-list" style="padding-left: 20px; list-style-type: circle; margin-top: 5px;"></ul>
                    </div>
                </div>

                <!-- Unclaimed Detail View -->
                <div id="dashboard-unclaimed-wrapper" style="display:none; margin-top: 10px;">
                    <button id="toggle-dashboard-unclaimed" class="text-btn" style="font-size: 0.85rem;">Show Unclaimed Details</button>
                    <div id="dashboard-unclaimed-details" style="display:none; text-align: left; margin: 10px auto; max-width: 500px; background: #fafafa; padding: 15px; border-radius: 6px; font-size: 0.9em; border: 1px solid #eee;">
                        <strong>Current Unclaimed Records:</strong>
                        <ul id="dashboard-unclaimed-list" style="padding-left: 20px; list-style-type: circle; margin-top: 5px;"></ul>
                    </div>
                </div>
            </div>

            <!-- 3. Active Round Widget -->
            <div id="collection-round-widget" class="info-card" style="display:none; margin-bottom: 20px;">
                <div class="card-header-flex">
                    <h3>Active Fund Round</h3>
                    <button id="round-history-btn" class="text-btn">View History</button>
                </div>
                <div class="round-content">
                    <h4 id="widget-round-title" style="margin-top: 0; color: #0078d7;">Loading...</h4>
                    
                    <div class="round-metrics">
                        <div class="metric-item">
                            <span class="label">Target:</span>
                            <span id="round-target" class="value">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="label">Collected:</span>
                            <span id="round-collected" class="value">-</span>
                        </div>
                        <div class="metric-item">
                             <span class="label">Avg/Unit:</span>
                             <span id="round-avg" class="value">-</span>
                        </div>
                        <div class="metric-item">
                             <span class="label">Units:</span>
                             <span id="round-count" class="value">-</span>
                        </div>
                    </div>

                    <div class="progress-container">
                        <div id="round-progress-bar" class="progress-fill" style="width: 0%;"></div>
                    </div>
                    <div style="text-align: right; font-size: 0.8rem; margin-top: 5px;">
                        <span id="round-percent">0%</span>
                    </div>

                    <p id="widget-round-remarks" class="round-remarks"></p>
                    <p class="small-note">Includes payments since <span id="widget-round-start-date">-</span> from participating units. (Does not include Unclaimed Records)</p>
                    
                    <div style="margin-top: 10px;">
                        <button id="widget-participant-toggle" class="text-btn" style="font-size: 0.85rem;">Show Participating Units</button>
                        <div id="widget-participant-list" style="display:none; margin-top: 5px; font-size: 0.8rem; background: #f9f9f9; padding: 10px; border-radius: 4px;"></div>
                    </div>
                </div>

                <!-- History Container (Hidden by default) -->
                <div id="round-history-container" style="display:none; margin-top: 15px; border-top: 1px solid #eee; padding-top: 15px;">
                     <h4 style="margin-top:0; font-size: 1rem;">Past Rounds</h4>
                     <ul id="round-history-list" style="list-style: none; padding: 0; font-size: 0.9rem;"></ul>
                </div>
            </div>
        </section>

        <!-- Public Payment Section -->
        <section id="submit-payment" class="view-section" style="display:none;">
            <h2>Submit Payment</h2>
            <div class="submit-container" style="max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;">
                <p>Residents can use this form to record their monthly contribution.</p>
                
                <form id="public-payment-form">
                    <fieldset>
                        <legend>Payment Details</legend>
                        <div class="form-group">
                            <label for="public-payment-unit">Unit Number:</label>
                            <select id="public-payment-unit" required>
                                <option value="">--Select Your Unit--</option>
                                <!-- Populated by JS -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="public-payment-amount">Amount (RM):</label>
                            <input type="number" id="public-payment-amount" min="0" step="0.01" required placeholder="e.g. 50.00">
                        </div>
                        <div class="form-group">
                            <label for="public-payment-date">Date of Payment:</label>
                            <input type="date" id="public-payment-date" required>
                        </div>
                        <div class="form-group">
                            <label for="public-payment-ref">Reference (e.g., Bank Ref / Month):</label>
                            <input type="text" id="public-payment-ref" placeholder="e.g. Ref 123456">
                        </div>
                        <div class="form-group">
                            <label for="public-payment-receipt">Receipt Image (Required):</label>
                            <input type="file" id="public-payment-receipt" accept="image/*,application/pdf" required>
                            <p class="small-note">Please contact admin if your upload fails.</p>
                        </div>
                        <button type="submit">Submit Payment</button>
                        <p class="small-note">Note: Submissions will be reviewed by Admin before appearing on dashboard.</p>
                        <p id="public-payment-status" class="small-note" style="margin-top: 10px;"></p>
                    </fieldset>
                </form>
            </div>
        </section>

        <!-- Admin Section -->
        <section id="admin" class="view-section" style="display:none;">
            <h2>Admin Interface</h2>
            
            <!-- Login State -->
            <div id="admin-login">
                <h3>Restricted Access</h3>
                <form id="login-form">
                    <div class="form-group">
                        <label for="admin-password">Master Password:</label>
                        <input type="password" id="admin-password" required placeholder="Enter Admin Password">
                    </div>
                    <button type="submit">Login</button>
                    <p class="small-note">Note: Uses Firebase Auth (your admin email)</p>
                </form>
            </div>

            <!-- Authenticated State -->
            <div id="admin-content" style="display:none;">
                <div class="admin-header">
                    <span>Welcome, Admin</span>
                    <button id="logout-btn">Logout</button>
                </div>
                
                <div class="admin-panel">
                    <h3>Management Options</h3>
                    
                    <!-- Admin Tabs Navigation -->
                    <div class="admin-tabs">
                        <button class="admin-tab active" data-tab="tab-bills">Monthly Bills</button>
                        <button class="admin-tab" data-tab="tab-payments">Payments</button>
                        <button class="admin-tab" data-tab="tab-units">Units</button>
                        <button class="admin-tab" data-tab="tab-rounds">Collection Rounds</button>
                        <button class="admin-tab" data-tab="tab-unclaimed">Unclaimed Funds</button>
                        <button class="admin-tab" data-tab="tab-system">System</button>
                    </div>

                    <!-- TAB 1: Monthly Bills -->
                    <div id="tab-bills" class="admin-tab-content active">
                    <form id="bill-form" class="admin-form">
                        <fieldset>
                            <legend>Record New Electric Bill</legend>
                            <div class="form-group">
                                <label for="bill-month">Month:</label>
                                <select id="bill-month" required>
                                    <option value="">--Select--</option>
                                    <option value="1">January</option>
                                    <option value="2">February</option>
                                    <option value="3">March</option>
                                    <option value="4">April</option>
                                    <option value="5">May</option>
                                    <option value="6">June</option>
                                    <option value="7">July</option>
                                    <option value="8">August</option>
                                    <option value="9">September</option>
                                    <option value="10">October</option>
                                    <option value="11">November</option>
                                    <option value="12">December</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="bill-year">Year:</label>
                                <input type="number" id="bill-year" min="2020" max="2100" required placeholder="e.g. 2024">
                            </div>
                            <div class="form-group">
                                <label for="bill-amount">Total Amount (RM):</label>
                                <input type="number" id="bill-amount" min="0" step="0.01" required placeholder="e.g. 123.45">
                            </div>
                            <div class="form-group">
                                <label for="bill-date">Bill Issue Date:</label>
                                <input type="date" id="bill-date" required>
                            </div>
                            <button type="submit">Save Bill</button>
                            <span id="bill-form-status" class="small-note"></span>
                        </fieldset>
                    </form>
                    <hr>
                    <section id="bill-history-section">
                        <h3>Bill History</h3>
                        <div class="table-wrapper">
                            <table id="bill-history-table">
                                <thead>
                                    <tr>
                                        <th>Month</th>
                                        <th>Year</th>
                                        <th>Amount (RM)</th>
                                        <th>Issue Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Bill rows will be dynamically inserted here -->
                                </tbody>
                            </table>
                        </div>
                        <span id="bill-history-status" class="small-note"></span>
                    </section>
                    </div>

                    <!-- TAB 2: Payments -->
                    <div id="tab-payments" class="admin-tab-content" style="display:none;">
                    <section id="payment-approval-section">
                        <h3>Pending Payment Approvals</h3>
                         <div class="table-wrapper">
                            <table id="pending-payment-table" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>Unit</th>
                                        <th>Amount</th>
                                        <th>Date</th>
                                        <th>Ref</th>
                                        <th>Receipt</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="6">Loading...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </section>

                    <p id="payment-placeholder" style="display:none;">Select an action below (Pending Implementation in PAY-1)</p>
                    <div class="admin-actions" style="display:none;">
                        <button disabled>Record Payment</button>
                    </div>

                    <form id="payment-form" class="admin-form">
                        <fieldset>
                            <legend>Record Unit Payment</legend>
                            <div class="form-group">
                                <label for="payment-unit">Unit Number:</label>
                                <select id="payment-unit" required>
                                    <option value="">--Select Unit--</option>
                                    <!-- Options will be populated by JS -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="payment-amount">Amount (RM):</label>
                                <input type="number" id="payment-amount" min="0" step="0.01" required placeholder="e.g. 50.00">
                            </div>
                            <div class="form-group">
                                <label for="payment-date">Date:</label>
                                <input type="date" id="payment-date" required>
                            </div>
                            <div class="form-group">
                                <label for="payment-ref">Reference/Note (Optional):</label>
                                <input type="text" id="payment-ref" placeholder="e.g. Oct Contribution">
                            </div>
                            <div class="form-group">
                                <label for="payment-receipt-file">Receipt Image:</label>
                                <input type="file" id="payment-receipt-file" accept="image/*,application/pdf">
                                <p class="small-note">Selecting a file will auto-upload to Admin's Google Drive upon record.</p>
                            </div>
                            <button type="submit">Record Payment</button>
                            <span id="payment-form-status" class="small-note"></span>
                        </fieldset>
                    </form>
                    
                    <hr>
                    <section id="payment-history-section">
                        <h3>Payment History per Unit</h3>
                        <div class="form-group">
                            <label for="history-unit-select">Select Unit to View:</label>
                            <select id="history-unit-select">
                                <option value="">--Select Unit--</option>
                                <!-- populated by JS -->
                            </select>
                        </div>
                        <div class="table-wrapper">
                            <table id="payment-history-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Amount (RM)</th>
                                        <th>Reference</th>
                                        <th>Receipt</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="5">Select a unit to view history.</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </section>
                    
                    <div style="text-align: right; margin-top: 10px;">
                        <button id="toggle-archive-btn" type="button" style="background-color: #6c757d;">View Archived Payments</button>
                    </div>

                    <section id="archived-payments-section" style="display:none; margin-top: 20px; padding: 15px; background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 5px;">
                        <h3>Archived Payments (Trash)</h3>
                        <div style="margin-bottom: 10px;">
                            <label for="archive-filter">Filter Source:</label>
                            <select id="archive-filter">
                                <option value="all">All Records</option>
                                <option value="deleted">Manually Deleted</option>
                                <option value="rejected">Rejected Submissions</option>
                            </select>
                        </div>
                        <p class="small-note">Records here are excluded from all totals.</p>
                        <div class="table-wrapper">
                            <table id="archived-history-table">
                                <thead>
                                    <tr>
                                        <th>Unit</th>
                                        <th>Date</th>
                                        <th>Amount (RM)</th>
                                        <th>Archived At</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="5">Loading archive...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </section>
                    </div>
                    
                    <!-- TAB 3: Units -->
                    <div id="tab-units" class="admin-tab-content" style="display:none;">
                    <section id="unit-management-section">
                        <h3>Unit Status Management</h3>
                        <form id="unit-status-form" class="admin-form">
                            <fieldset>
                                <legend>Edit Unit Status</legend>
                                <div class="form-group">
                                    <label for="admin-unit-select">Select Unit:</label>
                                    <select id="admin-unit-select" required>
                                        <option value="">--Select Unit--</option>
                                        <!-- populated by JS -->
                                    </select>
                                </div>
                                <div class="form-group" style="display: flex; align-items: center; gap: 10px;">
                                    <input type="checkbox" id="unit-highlight-check" style="width: auto;"> 
                                    <label for="unit-highlight-check" style="margin: 0; display: inline;">Highlight Unit (Special Status)</label>
                                </div>
                                <div class="form-group">
                                    <label for="unit-note-input">Public Note:</label>
                                    <input type="text" id="unit-note-input" placeholder="e.g. Hardship Exemption">
                                </div>
                                <button type="submit">Update Unit Status</button>
                                <span id="unit-status-form-status" class="small-note"></span>
                            </fieldset>
                        </form>
                    </section>
                    </div>

                    <!-- TAB 4: Rounds -->
                    <div id="tab-rounds" class="admin-tab-content" style="display:none;">
                    <section id="collection-rounds-section">
                        <h3>Collection Rounds Management</h3>
                        <form id="collection-round-form" class="admin-form">
                            <fieldset>
                                <legend>Create / Edit Collection Round</legend>
                                <input type="hidden" id="round-id">
                                
                                <div class="form-group">
                                    <label for="round-title">Round Title:</label>
                                    <input type="text" id="round-title" required placeholder="e.g. Lift Maintenance 2024">
                                </div>
                                
                                <div class="form-group">
                                    <label for="round-amount">Target Amount (RM):</label>
                                    <input type="number" id="round-amount" min="0" step="0.01" required placeholder="0.00">
                                </div>
                                
                                <div class="form-group">
                                    <label for="round-start-date">Start Date:</label>
                                    <input type="date" id="round-start-date" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="round-remarks">Remarks (For Public):</label>
                                    <textarea id="round-remarks" rows="2" placeholder="Explain the purpose of this collection..."></textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label>Participating Units:</label>
                                    <div class="unit-selector-container" style="border: 1px solid #ccc; max-height: 200px; overflow-y: auto; padding: 10px; background: #fff;">
                                         <div style="margin-bottom: 5px; border-bottom: 1px solid #eee; padding-bottom: 5px;">
                                            <input type="checkbox" id="round-all-units" style="width: auto;"> 
                                            <label for="round-all-units" style="display:inline; font-weight:bold; cursor:pointer;">Select All 44 Units</label>
                                         </div>
                                         <div id="round-unit-list" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 5px;">
                                            <!-- Checkboxes generated by JS -->
                                         </div>
                                    </div>
                                    <p class="small-note">Only selected units will be expected to contribute.</p>
                                </div>

                                <button type="submit" id="round-submit-btn">Save Collection Round</button>
                                <button type="button" id="round-cancel-btn" style="background-color: #6c757d; display:none;">Cancel Edit</button>
                                <span id="round-form-status" class="small-note"></span>
                            </fieldset>
                        </form>
                        
                        <h4>Existing Rounds</h4>
                        <div class="table-wrapper">
                            <table id="collection-rounds-table">
                                <thead>
                                    <tr>
                                        <th>Title</th>
                                        <th>Target (RM)</th>
                                        <th>Start Date</th>
                                        <th>Units</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="5">Loading...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </section>
                    </div>
                    
                    <!-- TAB 5: Unclaimed -->
                    <div id="tab-unclaimed" class="admin-tab-content" style="display:none;">
                    <section id="unclaimed-funds-section">
                        <h3>Finance Management</h3>
                        
                        <!-- Create New -->
                        <form id="unclaimed-form" class="admin-form">
                            <fieldset>
                                <legend>Add Unclaimed Fund Record</legend>
                                <p class="small-note">Log funds received with unknown source.</p>
                                
                                <div class="form-group">
                                    <label for="unclaimed-date">Date Received:</label>
                                    <input type="date" id="unclaimed-date" required>
                                </div>
                                <div class="form-group">
                                    <label for="unclaimed-amount">Amount (RM):</label>
                                    <input type="number" id="unclaimed-amount" min="0" step="0.01" placeholder="e.g. 50.00" required>
                                </div>
                                <div class="form-group">
                                    <label for="unclaimed-remarks">Remarks (Bank Ref / Desc):</label>
                                    <input type="text" id="unclaimed-remarks" placeholder="e.g. Cash Deposit CDM" required>
                                </div>

                                <button type="submit">Add Record</button>
                                <span id="unclaimed-form-status" class="small-note"></span>
                            </fieldset>
                        </form>

                        <!-- Active List -->
                        <h4>Active Unclaimed Records</h4>
                        <div class="table-wrapper">
                            <table id="unclaimed-table" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Amount</th>
                                        <th>Remarks</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody><tr><td colspan="4">Loading...</td></tr></tbody>
                            </table>
                        </div>

                        <!-- Archive Toggle -->
                        <div style="margin-top: 15px;">
                            <button id="toggle-unclaimed-archive" class="text-btn">View Archived Unclaimed</button>
                        </div>
                        <div id="unclaimed-archive-container" style="display:none; margin-top:10px;">
                            <h4>Archived Unclaimed</h4>
                            <div class="table-wrapper">
                                <table id="unclaimed-archive-table" style="width:100%">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Amount</th>
                                            <th>Remarks</th>
                                            <th>Archived At</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </section>
                    
                    <!-- Conversion Modal -->
                    <div id="convert-modal" class="modal">
                        <div class="modal-content">
                            <span id="close-convert-modal" class="close-modal">&times;</span>
                            <h3>Convert to Payment</h3>
                            <p>Assign this unclaimed fund to a unit.</p>
                            
                            <form id="convert-form">
                                <input type="hidden" id="convert-id">
                                <input type="hidden" id="convert-amount-hidden">
                                
                                <p><strong>Amount:</strong> RM <span id="convert-display-amount"></span></p>
                                <p><strong>Date:</strong> <span id="convert-display-date"></span></p>
                                <p><strong>Remarks:</strong> <span id="convert-display-remarks"></span></p>
                                
                                <div class="form-group">
                                    <label for="convert-unit">Assign Unit:</label>
                                    <select id="convert-unit" required class="full-width">
                                        <!-- Populated via JS -->
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="convert-receipt">Upload Receipt (Optional):</label>
                                    <input type="file" id="convert-receipt">
                                </div>

                                <button type="submit" style="background-color: var(--success-color);">Confirm Conversion</button>
                            </form>
                        </div>
                    </div>
                    </div>

                    <!-- TAB 6: System -->
                    <div id="tab-system" class="admin-tab-content" style="display:none;">
                    <section id="system-config-section">
                        <h3>System Configuration</h3>
                        <form id="threshold-form" class="admin-form">
                            <fieldset>
                                <legend>Manual Threshold Override</legend>
                                <p class="small-note">Overrides the auto-calculated break-even target per unit.</p>
                                
                                <div class="form-group" style="display: flex; align-items: center; gap: 10px;">
                                    <input type="checkbox" id="threshold-override-check" style="width: auto;"> 
                                    <label for="threshold-override-check" style="margin: 0; display: inline;">Enable Manual Override</label>
                                </div>

                                <div class="form-group">
                                    <label for="threshold-amount">Manual Target Amount (RM):</label>
                                    <input type="number" id="threshold-amount" min="0" step="0.01" placeholder="e.g. 100.00" disabled>
                                </div>

                                <button type="submit">Save Threshold Settings</button>
                                <span id="threshold-form-status" class="small-note"></span>
                            </fieldset>
                        </form>
                    </section>

                    <hr>
                    <section id="data-export-section">
                        <h3>Data Backup</h3>
                        <div class="admin-form">
                            <fieldset>
                                <legend>Export System Data</legend>
                                <p class="small-note">Download a copy of all Bills and Payments.</p>
                                <button id="export-data-btn" type="button" style="background-color: #28a745;">Download Data (JSON)</button>
                                <span id="export-status" class="small-note"></span>
                            </fieldset>
                        </div>
                    </section>
                    </div>
                </div>
            </div>
        </section>

        <!-- Round History Modal -->
        <div id="round-history-modal" class="modal">
            <div class="modal-content">
                <span id="close-round-history" class="close-modal">&times;</span>
                <h3>Collection Round History</h3>
                <div id="round-history-list" class="history-list">
                    <p>Loading...</p>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <p style="font-size: 0.9em; color: #888; margin-top: 4px;">
            This page is created as an experiment. The creator is not responsible for any damages or losses caused by using it.
        </p>
    </footer>

    <!-- Firebase SDKs (using version 10.7.1 compat for simpler script tag usage without bundlers, or standard modular via module scripts) -->
    <!-- Utilizing the numbered version to ensure stability. Using compat libraries for easier standalone script usage without a build step. -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- App Scripts -->
    <script src="js/config.js"></script>
    <script src="js/drive.js"></script>
    <script async defer src="https://accounts.google.com/gsi/client" onload="handleGisLoad()"></script>

    <script src="js/db.js"></script>
    <script src="js/models.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
